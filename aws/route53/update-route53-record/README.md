update-route53-record
===

### 概要

本スクリプトはRoute53の特定のゾーンのレコードを追加・更新するためのスクリプトです。  
削除のみは行なえません。  
※使っているcli53コマンドには削除のサブコマンドはありますが、目的外となるため未実装です。  

### 使い方

1. スクリプト内の `ZONE_NAME` より、更新したいホストゾーンを確認（必要に応じて修正）します。
2. `./update-route53-record.sh backup` を実行して既存のゾーン情報をバックアップします。
3. import.txt を修正し、新しいレコードを追加（または更新）します。
4. `./update-route53-record.sh upsert` を実行して、更新します（実行してよいかは確認されます）。
    1. もし既に追加済みのレコードの場合は、変更なしとして処理されます。
    2. 追加済みレコードと新規レコードが存在していた場合は、新規レコードのみが追加されます。
    3. 新規レコードと値のみ更新したレコードが存在していた場合は、新規レコード追加と更新処理が実行されます。
5. 実行されたらアップデート後の結果がローカルに出力されるため　`diff -u バックアップファイル アップデート後のファイル` で確認します。
6. import.txt ファイルを `bastion` インスタンスにコピーして、下記コマンドにて正常に名前解決されることを確認します。
```sh
for i in $(cat import.txt | awk '{print $(NF-0)}');do dig $i +short;done
```
1. 上記ですべて正常に名前解決出来ることを確認したらOKです。

